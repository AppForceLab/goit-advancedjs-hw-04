{"version":3,"file":"commonHelpers.js","sources":["../src/search.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '36804673-b7c86e83fae38f10ed9b56d3d';\n\nconst PARAMS = {\n  key: API_KEY,\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n};\n\nfunction getSearchUrl(params) {\n  return BASE_URL + '?' + params;\n}\n\nfunction getParams(query, template) {\n  template.q = query;\n  return new URLSearchParams(template);\n}\n\nasync function fetchUrl(query, searchTemplate = { key: API_KEY }) {\n  try {\n    const params = getParams(query, searchTemplate);\n    const data = await axios.get(getSearchUrl(params));\n    return data;\n  } catch (error) {\n    // Handle error, log it, or throw a custom error\n    console.error('Error fetching data:', error.message);\n    throw new Error('An error occurred while fetching data.');\n  }\n}\n\nexport function findImages(searchQuery, per_page = 20, page = 1) {\n  PARAMS.per_page = per_page;\n  PARAMS.page = page;\n\n  return fetchUrl(searchQuery, PARAMS);\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { findImages } from './search';\n\nconst elements = {\n  searchForm: document.querySelector('.search-form'),\n  searchButton: document.querySelector('button[type=\"submit\"]'),\n  gallery: document.querySelector('.gallery'),\n  guard: document.querySelector('.js-guard'),\n};\n\nconst PER_PAGE = 40;\nlet totalHits = 0;\nlet currentPage = 1;\nlet searchQuery = '';\nlet gallery;\n\nconst guardOptions = {\n  root: null,\n  rootMargin: '250px',\n  threshold: 1.0,\n};\n\nconst scrollObserver = new IntersectionObserver(handlerLoadMore, guardOptions);\n\nfunction initializeLightbox() {\n  gallery = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n}\n\nfunction handlerLoadMore(entries) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      handleIntersection();\n    }\n  });\n}\n\nfunction handleIntersection() {\n  currentPage += 1;\n  const searchResult = findImages(searchQuery, PER_PAGE, currentPage);\n\n  searchResult\n    .then(result => {\n      renderSearchResult(result.data);\n\n      if (PER_PAGE * currentPage >= totalHits) {\n        scrollObserver.unobserve(elements.guard);\n        showMessage(\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n      }\n    })\n    .catch(err => showErrorMessage(err.message));\n}\n\nfunction getListItemsHTML(hits) {\n  return hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <div class=\"photo-card\">\n        <a href=\"${largeImageURL}\">\n          <img class=\"image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes</b> ${likes}\n        </p>\n            <p class=\"info-item\">\n        <b>Views</b> ${views}\n        </p>\n        <p class=\"info-item\">\n            <b>Comments</b> ${comments}\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads</b> ${downloads}\n        </p>\n    </div>\n</div>\n      </div>\n    `\n    )\n    .join('');\n}\n\nfunction renderSearchResult(data) {\n  elements.gallery.insertAdjacentHTML('beforeend', getListItemsHTML(data.hits));\n  gallery.refresh();\n\n  window.scrollBy({\n    top: 0,\n    behavior: 'smooth',\n  });\n}\n\nfunction showMessage(message, backgroundColor = 'green', timeout = 3000) {\n  iziToast.show({\n    message,\n    messageColor: 'white',\n    backgroundColor,\n    timeout,\n    position: 'topRight',\n  });\n}\n\nfunction showErrorMessage(errorMessage) {\n  showMessage(errorMessage, 'tomato', 3000);\n}\n\nfunction resetSearchData() {\n  elements.gallery.innerHTML = '';\n  totalHits = 0;\n  currentPage = 1;\n  searchQuery = '';\n}\n\nfunction onSearchButtonClick(evt) {\n  evt.preventDefault();\n  const form = new FormData(elements.searchForm);\n  const userInput = form.get('searchQuery').trim().toLowerCase();\n\n  if (!userInput) {\n    showErrorMessage('Hey! Enter something!');\n    return;\n  }\n\n  scrollObserver.unobserve(elements.guard);\n  resetSearchData();\n\n  searchQuery = userInput;\n  const searchResult = findImages(searchQuery, PER_PAGE);\n\n  searchResult\n    .then(result => {\n      if (result.data.hits.length === 0) {\n        throw new Error(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n      }\n\n      totalHits = result.data.totalHits;\n\n      showMessage(`Hooray! We found ${totalHits} images.`);\n      renderSearchResult(result.data);\n\n      if (PER_PAGE * currentPage < totalHits) {\n        scrollObserver.observe(elements.guard);\n      }\n    })\n    .catch(err => showErrorMessage(err.message));\n}\n\nfunction init() {\n  initializeLightbox();\n  elements.searchButton.addEventListener('click', onSearchButtonClick);\n}\n\n// Initialize the application\ninit();\n"],"names":["BASE_URL","API_KEY","PARAMS","getSearchUrl","params","getParams","query","template","fetchUrl","searchTemplate","axios","error","findImages","searchQuery","per_page","page","elements","PER_PAGE","totalHits","currentPage","gallery","guardOptions","scrollObserver","handlerLoadMore","initializeLightbox","SimpleLightbox","entries","entry","handleIntersection","result","renderSearchResult","showMessage","err","showErrorMessage","getListItemsHTML","hits","webformatURL","largeImageURL","tags","likes","views","comments","downloads","data","message","backgroundColor","timeout","iziToast","errorMessage","resetSearchData","onSearchButtonClick","evt","userInput","init"],"mappings":"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"}